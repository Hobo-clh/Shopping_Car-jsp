<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
        <meta name="author" content="order by dede58.com"/>
		<title>用户注册</title>
		<link rel="stylesheet" type="text/css" href="./css/login.css">
		<style>
				body{
					background-image:url("./img/zhuce.jpg")
				}
		</style>
	</head>
	<body>
		<form  method="post" action="RegisterHandle">
		<div class="regist">
			<div class="regist_center">
				<div class="regist_top">
					<div class="left fl">会员注册</div>
					<div class="right fr"><a href="./index.jsp" target="_self">华华汽车商城</a></div>
					<div class="clear"></div>
					<div class="xian center"></div>
				</div>
				<div class="regist_main center">
					<div class="username">用&nbsp;&nbsp;户&nbsp;&nbsp;名:&nbsp;&nbsp;
					<input class="shurukuang" type="text" name="username" placeholder="用户名大于2位数" id="username" onblur="checkUsername(this.value)" />
					<span id="usrnm"></span></div>
					<div class="username">密&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;码:&nbsp;&nbsp;<input class="shurukuang" type="password" name="password" placeholder="密码大于5位数" id="password" />
					<span id="pswd"></span></div>
					<div class="username">确认密码:&nbsp;&nbsp;<input class="shurukuang" type="password" name="repassword" placeholder="请确认你的密码" id="qrpswd" />
					<span id="yzmm"></span></div>
				</div>
				<div class="regist_submit">
					<input class="submit" type="submit" name="submit" value="立即注册" id="ljzhuce">
				</div>
				
			</div>
		</div>
		</form>
	</body>
</html>

<script type="text/javascript">
	window.onload=function(){
		var usrnm=document.getElementById("usrnm")
		var pswd=document.getElementById("pswd")
		var yzmm=document.getElementById("yzmm")
		var username=document.getElementById("username")
		var password=document.getElementById("password")
		var qrpswd=document.getElementById("qrpswd")
		
	document.getElementById("password").onblur=function(){
		
		password.value=password.value.trim();
		if(password.value.length<6){
			pswd.innerText="密码过短！！！"
		}
	}
	document.getElementById("qrpswd").onblur=function(){
		
		qrpswd.value=qrpswd.value.trim();
		if(qrpswd.value!=password.value){
			yzmm.innerText="两次密码不一致"
			
		}
	}
	document.getElementById("username").onfocus=function(){
		usrnm.innerText=""
		pswd.innerText=""
		yzmm.innerText=""
	}
	document.getElementById("password").onfocus=function(){
		pswd.innerText=""
		yzmm.innerText=""
	}
	document.getElementById("qrpswd").onfocus=function(){
		yzmm.innerText=""
	}
	// 注册判断
	document.getElementById("ljzhuce").onclick=function(){
		var username=document.getElementById("username").value;
		var password=document.getElementById("password").value;
		var qrpswd=document.getElementById("qrpswd").value;

		if(username.length<2||username.length>13){
			alert("账号必须大于2位数、小于14位数！！")
			return false;
		}
		if(password.length<6){
			alert("密码至少要6位数！！！")
			return false;
		}
		if(password!=qrpswd){
			alert("兄dei，您的密码不一致！")
			return false;
		}
	}
}
	//注册AJAX请求判断用户名是否存在
	function checkUsername(username){
		//1、创建AJAX核心对象XMLHttpRequest（浏览器内置）
		var xhr;
		if(window.XMLHttpRequest){
			xhr = new XMLHttpRequest();
		}else{
			xhr = ActiveXObject("Microsoft.XMLHTTP");//ie5 ie6用是这个对象发送请求，情况下不用
		}
		//2、注册回调函数
		/*
			XMLHttpRequest对象在请求和响应的过程中，该对象的readState状态从0~4
			0：请求初始化
			1：服务器建立连接
			2：请求已接受
			3：请求处理中
			4：请求已完成，且响应已就绪
		*/
		xhr.onreadystatechange = function(){
			if(xhr.readyState==4){
				//404 500错误 
				if(xhr.status==200){//200表示服务器正常
					var s = xhr.responseText;
					document.getElementById("usrnm").innerHTML=s;
				}else{
					alert(xhr.status);
				}
			}
		}
		
		//3、开启浏览器和服务器之间的通道
		/* 
			method:指定请求方式为get还是post
			url:请求路径
			async: true/false (true表示支持异步，false表示支持同步)
		*/
		xhr.open("get","/Shopping/checkusername.do?username="+username,true);
		//4、发送AJAX请求
		xhr.send();	
}

	</script>